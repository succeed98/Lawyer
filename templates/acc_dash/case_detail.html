{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load auth_extras %}
{% load mathfilters %}


{% block content %}
<div class="page-content">
<div class="container-fluid">
    <!-- Page-Title -->
    <div class="row">
        <div class="col-sm-12">
            <div class="page-title-box">
                <div class="float-right">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{% url 'account_dash' %}">Lawyer System.</a></li>
                        <li class="breadcrumb-item"><a href="javascript:void(0);">Cases</a></li>
                        <li class="breadcrumb-item active">Case Detail</li>
                    </ol><!--end breadcrumb-->
                </div><!--end /div-->
                <h4 class="page-title">{{case}}</h4>
            </div><!--end page-title-box-->        </div><!--end col-->
    </div><!--end row-->
    <!-- end page title end breadcrumb -->
    <div class="row">
        <div class="col-lg-4">
            <div class="card">
                <div class="card-body dash-info-carousel mb-0">

                    <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                        <div class="carousel-inner">
                            {% for lawyer in users  %}

                            {% if users.count == 1 %}
                            <div class="carousel-item active">
                                <div class="row">
                                    <div class="col-12 align-self-center">
                                        <div class="text-center">
                                            <h4 class="mt-0 header-title text-left">Assigned Lawyers</h4>
                                            <div class="my-3">
                                                {% if lawyer.user.avatar %}
                                                <img src="{{lawyer.user.avatar.url}}" alt="" height="80" style="border-radius:50%;"
                                                    class="">

                                                     {% else %}
                                                    <img src="{% static 'assets/images/holder.jpg' %}" alt="" height="80" style="border-radius:50%;"
                                                    class="">
                                                    {% endif %}
                                            </div>
                                            <h2 class="project-title mb-1">{{lawyer|title}}</h2>
                                            <p class="mb-1 text-muted"><span class="mr-2 text-secondary font-14"><b>{{lawyer.email}}</b></span>{{lawyer.phone}}</p>
                                        </div>
                                    </div>
                                    <!--end col-->
                                </div>
                                <!--end row-->
                            </div>
                            {% else %}

                            {% if forloop.first %}
                            <div class="carousel-item active ">
                                <div class="row">
                                    <div class="col-12 align-self-center">
                                        <div class="text-center">
                                            <h4 class="mt-0 header-title text-left">Assigned Lawyers</h4>
                                            <div class="my-3">
                                                {% if lawyer.user.avatar %}
                                                <img src="{{lawyer.user.avatar.url}}" alt="" height="80" style="border-radius:50%;"
                                                    class="">
                                                     {% else %}
                                                    <img src="{% static 'assets/images/holder.jpg' %}" alt="" height="80" style="border-radius:50%;"
                                                    class="">
                                                    {% endif %}
                                            </div>
                                            <h2 class="project-title mb-1">{{lawyer|title}}</h2>
                                            <p class="mb-1 text-muted"><span class="mr-2 text-secondary font-14"><b>{{lawyer.email}}</b></span>{{lawyer.phone}}</p>

                                            <!-- <p class="mb-1 text-muted"><span class="mr-2 text-secondary font-14"><b>190 Days</b></span> Tuesday, 25 July 2019</p> -->
                                        </div>
                                    </div>
                                    <!--end col-->
                                </div>
                                <!--end row-->
                            </div>



                            {% else %}
                            <div class="carousel-item">
                                <div class="row">
                                    <div class="col-12 align-self-center">
                                        <div class="text-center">
                                            <h4 class="mt-0 header-title text-left">Assigned Lawyers</h4>
                                            <div class="my-3">
                                                {% if lawyer.user.avatar %}
                                                <img src="{{lawyer.user.avatar.url}}" alt="" height="80" style="border-radius:50%;"
                                                    class="">
                                                    {% else %}
                                                    <img src="{% static 'assets/images/holder.jpg' %}" alt="" height="80" style="border-radius:50%;"
                                                    class="">
                                                    {% endif %}
                                            </div>
                                            <h2 class="project-title mb-1">{{lawyer|title}}</h2>
                                            <p class="mb-1 text-muted"><span class="mr-2 text-secondary font-14"><b>{{lawyer.email}}</b></span>{{lawyer.phone}}</p>

                                            <!-- <p class="mb-1 text-muted"><span class="mr-2 text-secondary font-14"><b>190 Days</b></span> Tuesday, 25 July 2019</p> -->
                                        </div>
                                    </div>
                                    <!--end col-->
                                </div>
                                <!--end row-->
                            </div>

                            {% endif %}






                            {% endif %}


                            <!--end carousel-item-->
                            {% endfor %}



                        </div>
                        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div><!--end card-body-->
            </div><!--end card-->
        </div><!-- end col-->
        <div class="col-lg-8">
            <div class="row">
                <div class="col-lg-4">
                    <div class="card hospital-info">
                        <div class="card-body">
                            <h4 class="header-title mt-0 mb-3">File Number</h4>
                            <div class="media">
                                <div class="data-icon align-self-center">
                                    <i class="fas fa-folder rounded-circle text-danger"></i>
                                </div>
                                <div class="media-body ml-3 align-self-center text-right">
                                    <h5 class="mt-0">{{case.case_number}}</h5>
                                    <!-- <p class="text-muted mb-0 text-nowrap">Yesterday 32 App.</p>                                                                                             -->
                                </div><!--end media body-->
                            </div>
                        </div><!--end card-body-->
                    </div><!--end card-->
                </div><!-- end col-->
                <div class="col-lg-4">
                    <div class="card hospital-info">
                        <div class="card-body">
                            <h4 class="header-title mt-0 mb-3">Court</h4>
                            <div class="media">
                                <div class="data-icon align-self-center">
                                    <i class="fas fa-home rounded-circle text-warning"></i>
                                </div>
                                <div class="media-body ml-3 align-self-center text-right">
                                    <h5 class="mt-0">{{case.court|title}} </h5>
                                    <!-- <p class="text-muted mb-0 text-nowrap">Yesterday 22 Add.</p>                                                                                          -->
                                </div><!--end media body-->
                            </div>
                        </div><!--end card-body-->
                    </div><!--end card-->
                </div><!-- end col-->
                <div class="col-lg-4">
                    <div class="card hospital-info">
                        <div class="card-body">
                            <h4 class="header-user mt-0 mb-3">Representation</h4>
                            <div class="media">
                                <div class="data-icon align-self-center">
                                    <i class="fas fa-user rounded-circle text-success"></i>
                                </div>
                                <div class="media-body ml-3 align-self-center text-right">
                                    <h5 class="mt-0">{{case.representative}}</h5>
                                    <!-- <p class="text-muted mb-0 text-nowrap">Yesterday 12 Ope.</p>                                                                                      -->
                                </div><!--end media body-->
                            </div>
                        </div><!--end card-body-->
                    </div><!--end card-->
                </div><!-- end col-->

                <div class="col-lg-4">
                    <div class="card hospital-info">
                        <div class="card-body">
                            <h4 class="header-title mt-0 mb-3">Lead Professional</h4>
                            <div class="media">
                                <div class="data-icon align-self-center">
                                    <i class="fas fa-user rounded-circle text-info"></i>
                                </div>
                                <div class="media-body ml-3 align-self-center text-center">
                                    <h6 class="mt-0">{{case.lead_professional|title}}</h6>
                                    <!-- <p class="text-muted mb-0 text-nowrap">Today Available</p>                                                                                     -->
                                </div><!--end media body-->
                            </div>
                        </div><!--end card-body-->
                    </div><!--end card-->
                </div><!-- end col-->
                <div class="col-lg-4">
                    <div class="card hospital-info">
                        <div class="card-body">
                            <h4 class="header-title mt-0 mb-3">Team</h4>
                            <div class="media">
                                <div class="data-icon align-self-center">
                                    <i class="fas fa-user-friends rounded-circle text-blue"></i>
                                </div>
                                <div class="media-body ml-3 align-self-center text-center">
                                    <h6 class="mt-0">{{case.team}}</h6>
                                    <!-- <p class="text-muted mb-0 text-nowrap">Today Available</p>                                                                                     -->
                                </div><!--end media body-->
                            </div>
                        </div><!--end card-body-->
                    </div><!--end card-->
                </div><!-- end col-->
                <div class="col-lg-4">
                    <div class="card hospital-info">
                        <div class="card-body">
                            <h4 class="header-title mt-0 mb-3">Clients</h4>
                            <div class="media">
                                <div class="data-icon align-self-center">
                                    <i class="fas fa-user rounded-circle text-pink"></i>
                                </div>
                                <div class="media-body ml-3 align-self-center text-right">
                                    {% for client in clients  %}
                                    <h6 class="mt-0">{{client}}</h6>
                                    {% endfor %}
                                    <!-- <p class="text-muted mb-0 text-nowrap">Yesterday's $38,990</p>                                                                                    -->
                                </div><!--end media body-->
                            </div>
                        </div><!--end card-body-->
                    </div><!--end card-->
                </div><!-- end col-->
            </div><!--end row-->
        </div><!--end col-->
    </div><!--end row-->

    <div class="card">
        <div class="card-body">
            <h4 class="mt-0 header-title"></h4>
            <p class="text-muted">
            </p>
            <div class="accordion" id="accordionExample-faq">
                <div class="card shadow-none border mb-1">
                    <div class="card-header" id="headingOne">
                    <h5 class="my-0">
                        <button class="btn btn-link ml-4" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            Court Sessions
                        </button>
                    </h5>
                    </div>

                    <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample-faq">
                    <div class="card-body">

                        {% include "cases/snippets/session_list.html" with session_object=session_object %}

                    </div>
                    </div>
                </div>
                <div class="card shadow-none border mb-1">
                    <div class="card-header" id="headingTwo">
                    <h5 class="my-0">
                        <button class="btn btn-link collapsed ml-4 align-self-center" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                          Hours Spent ({{timer_sum}} hours)
                        </button>
                    </h5>
                    </div>
                    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample-faq">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="card">
                                    <div class="card-body">
                                        <span class="float-right text-muted font-weight-normal"></span>
                                        <h1 class="font-54 font-weight-normal mt-0 mb-4">{{timer_sum}}</h1>
                                        <h5 class="mb-0 font-weight-normal">Total Hours</h5>
                                    </div><!--end card-body-->
                                </div><!--end card-->
                            </div><!--end col-->
                            <div class="col-lg-6">
                                <div class="card">
                                    <div class="card-body">
                                        <span class="float-right text-muted font-weight-normal"></span>
                                        <h1 class="font-54 font-weight-normal mt-0 mb-4">{{timer_avg}}</h1>
                                        <h5 class="mb-0 font-weight-normal">Average Hours</h5>
                                    </div><!--end card-body-->
                                </div><!--end card-->
                            </div><!--end col-->




                        </div><!--end row-->


                        <div class="table-responsive dash-social">
                            <table id="datatable" class="table">
                                <thead>
                                    <tr>

                                        <th>User</th>
                                        <th>Case</th>
                                        <th>Time Spent</th>



                                    </tr>
                                </thead>


                                <!-- load -->


                                <tbody>

                                    {% for timer in  timer_list %}
                                    <tr>
                                        <td> {{timer.user|title}}
                                        </td>
                                        <td> {{timer.case|title}} </td>
                                        <td>{{timer.time_spent|intdiv:60 }} Minutes  </td>
                                                                  </tr>
                                    {% endfor %}

                                    <!--end tr-->
                                </tbody>
                            </table>
                        </div>

                    </div>
                    </div>
                </div>
                <div class="card shadow-none border mb-1">
                    <div class="card-header" id="headingThree">
                    <h5 class="my-0">
                        <button class="btn btn-link collapsed ml-4" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                          Terms of Engagement
                        </button>
                    </h5>
                    </div>
                    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample-faq">
                    <div class="card-body">
                        <table id="datatable" class="table">
                            <thead class="thead-light">
                                <tr>
                                    <th>#</th>
                                    <th>Added By</th>
                                    <th>Title</th>

                                    <th> Date</th>

                                    <th>Action</th>


                                </tr>
                                <!--end tr-->
                            </thead>
                            <tbody>
                        {% for terms in termsofengagement %}
                        <tr>
                            <td>{{forloop.counter}}</td>
                            <td>{{terms.added_by}}</td>
                            <td>{{terms.title}} </td>
                            <td>{{terms.date_add}}</td>
                            <td><a href="{{terms.upload_file.url}}" class="btn btn-gradient-primary">Download</a>
                            </td>                   
                        
                        
                                
                        </tr>
                        {% endfor %}
                    </tbody>
                        </table>
                    </div>
                    </div>
                </div>
                <div class="card shadow-none border mb-1">
                    <div class="card-header" id="headingThree">
                    <h5 class="my-0">
                        <button class="btn btn-link collapsed ml-4" type="button" data-toggle="collapse" data-target="#collapseterms" aria-expanded="false" aria-controls="collapseThree">
                          Retainer Terms of Engagement
                        </button>
                    </h5>
                    </div>
                    <div id="collapseterms" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample-faq">
                    <div class="card-body">
                        <table id="datatable" class="table">
                            <thead class="thead-light">
                                <tr>
                                    <th>#</th>
                                    <th>Added By</th>

                                    <th> Date</th>

                                    <th>Action</th>


                                </tr>
                                <!--end tr-->
                            </thead>
                            <tbody>
                        {% for terms in retainertermsofengagement %}
                        <tr>
                            <td>{{forloop.counter}}</td>
                            <td>{{terms.added_by}}</td>
                            <td>{{terms.date_add}}</td>
                            <td><a href="{{terms.file.url}}" class="btn btn-gradient-primary">Download</a>
                            </td>                   
                        
                        
                                
                        </tr>
                        {% endfor %}
                    </tbody>
                        </table>
                    </div>
                    </div>
                </div>
                <div class="card shadow-none border mb-1">
                    <div class="card-header" id="headingThree">
                    <h5 class="my-0">
                        <button class="btn btn-link collapsed ml-4" type="button" data-toggle="collapse" data-target="#collapseThrees" aria-expanded="false" aria-controls="collapseThree">
                         Expenses
                        </button>
                    </h5>
                    </div>
                    <div id="collapseThrees" class="collapse" aria-labelledby="headingThrees" data-parent="#accordionExample-faq">
                    <div class="card-body">

                        <div class="table-responsive dash-social">
                            <p class="text text-muted">Total Expenses : &#8373; {{expense_sum}}</p>
                            <table id="datatable" class="table datatable">
                                <thead>
                                    <tr>

                                        <th>Case</th>
                                        <th>Description</th>
                                        <th>Amount (&#8373;)</th>
                                        <th>Date Added</th>
                                        <th>Added By</th>

                                    </tr>
                                </thead>


                                <!-- load -->
                                <tbody>
                                    {% for exp in  expense_list %}
                                    <tr>

                                        <td>{{exp.case.name|title}}</td>
                                        <td>{{exp.description|title}}</td>



                                        <td> <span class="badge badge-md   badge-soft-success">{{exp.amount}}</span>
                                            </td>
                                        <td> {{exp.timestamp|date}}</td>
                                        <td>{{exp.user|title}}</td>
                                    </tr>
                                    {% endfor %}
                                    <!--end tr-->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    </div>
                </div>
            </div><!--end accordion-->
        </div><!--end card-body-->
    </div><!--end card-->




    </div>
</div>

{% endblock content %}